# コード修正ルール

このドキュメントは、プロジェクトのコード修正における基本ルールを定義します。
既存コードの保守性を維持し、品質を確保するため、以下のルールに従ってコードを修正してください。

## 目的
1. 既存コードの意図を尊重し、不必要な変更を防ぐ
2. インポート文の管理を適切に行い、依存関係を明確にする
3. コード修正時のミスを防ぎ、品質を維持する
4. レビューの効率を向上させる

## 1. 基本原則

### 1.1. 既存コードの尊重
- 既存のコードは可能な限り保持する
- 必要な部分のみを最小限で修正する
- 削除する前に、その部分が本当に不要かを確認する

### 1.2. 修正手順
1. 修正前に必ず既存コードを読む
2. 既存の処理ロジックを理解する
3. 影響範囲を特定する
4. 最小限の変更で目的を達成する

### 1.3. インポート文の管理
- 既存のインポート文は維持する
- 新規に必要なインポートのみを追加する
- 未使用のインポートは削除する
- インポート順序は既存の順序に従う

## 2. コード修正のチェックリスト

### 2.1. 修正前の確認
- [ ] 既存コードの全体を読んで理解した
- [ ] 修正が必要な箇所を特定した
- [ ] 影響を受ける他のコードを確認した
- [ ] 既存のテストケースを確認した

### 2.2. 修正時の確認
- [ ] 既存の処理ロジックを維持している
- [ ] 不要なコードの削除を最小限に抑えている
- [ ] 必要なインポート文をすべて追加している
- [ ] コードスタイルを既存のものに合わせている

### 2.3. 修正後の確認
- [ ] 既存のテストがすべてパスする
- [ ] 新しい機能が正しく動作する
- [ ] パフォーマンスに影響がない
- [ ] 不要なインポート文が残っていない

## 3. 推奨プラクティス

### 3.1. コードの追加
```java
// 悪い例：既存コードを全て削除して新しく書き直す
public class ExampleService {
    // 新しい実装
}

// 良い例：既存コードを活かしつつ追加する
public class ExampleService {
    // 既存のコード
    private final Repository repository;
    
    // 新しいコードを追加
    private final Cache cache;
```

### 3.2. インポートの管理
```java
// 悪い例：既存のインポートを全て削除して書き直す
import new.package.*;

// 良い例：既存のインポートを維持しつつ追加する
// 既存のインポート
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

// 新規に追加するインポート
import org.springframework.cache.annotation.Cacheable;
```

## 4. レビュー基準

### 4.1. 既存コードの変更
- 既存の機能が正しく維持されているか
- 不必要な削除が行われていないか
- 既存のコーディングスタイルが維持されているか

### 4.2. 新規追加コード
- 既存のコードと整合性が取れているか
- 必要なインポートが適切に追加されているか
- テストが適切に追加されているか

### 4.3. ドキュメント
- 変更内容が適切にコメントされているか
- 必要に応じてJavaDocが更新されているか
- 設計ドキュメントが更新されているか

## 5. エラー防止のためのプラクティス

### 5.1. コードの変更前
1. 現在の実装をバックアップする
2. 既存のテストをすべて実行する
3. 修正箇所の依存関係を確認する

### 5.2. コードの変更中
1. 小さな変更単位でコミットする
2. 変更のたびにテストを実行する
3. 不明な点があれば必ずチームに確認する

### 5.3. コードの変更後
1. すべてのテストが成功することを確認
2. コードレビューを依頼する
3. 必要に応じてリファクタリングを行う